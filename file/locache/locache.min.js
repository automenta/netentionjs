(function(){function c(a){a&&a.storage&&(this.storage=a.storage);this.async.set=this.async.set.bind(this);this.async.get=this.async.get.bind(this)}var d=this;c.prototype.VERSION="0.3.1";var g=c.prototype,h;try{d.localStorage.setItem("___locache___","___locache___"),d.localStorage.getItem("___locache___"),d.localStorage.removeItem("___locache___"),h=!0}catch(l){h=!1}var j=g.supportsLocalStorage=h,g=c.prototype,f;try{d.sessionStorage.setItem("___locache___","___locache___"),d.sessionStorage.getItem("___locache___"),
d.sessionStorage.removeItem("___locache___"),f=!0}catch(m){f=!1}var k=g.supportsSessionStorage=f;c.prototype.supportsNativeJSON=!!d.JSON;var i=c.prototype._defer=function(){function a(a){this.fn=a}var b=[];d.addEventListener("message",function(a){if(!(a.source!==d||"function-defer-message"!==a.data))if(a.stopPropagation(),0!==b.length)return b.shift()(),!1},!0);a.prototype.defer=function(){this.resultValue=this.fn();this.hasOwnProperty("finishedFunction")&&this.finishedFunction(this.resultValue)};
a.prototype.hasFinished=function(){return this.hasOwnProperty("resultValue")};a.prototype.finished=function(a){this.finishedFunction=a;this.hasFinished()&&this.finishedFunction(this.resultValue);return this};return function(e){e=new a(e);b.push(e.defer.bind(e));d.postMessage("function-defer-message","*");return e}}();c.prototype.cachePrefix="___locache___";c.prototype.expirePrefix="___locacheExpire___";c.prototype.backends={local:{set:function(a,b){return d.localStorage.setItem(a,b)},get:function(a){return d.localStorage.getItem(a)},
remove:function(a){return d.localStorage.removeItem(a)},length:function(){return d.localStorage.length},key:function(a){if(!(0>a||a>=this.length()))return d.localStorage.key(a)},enabled:function(){return j}},session:{set:function(a,b){return d.sessionStorage.setItem(a,b)},get:function(a){return d.sessionStorage.getItem(a)},remove:function(a){return d.sessionStorage.removeItem(a)},length:function(){return d.sessionStorage.length},key:function(a){if(!(0>a||a>=this.length()))return d.sessionStorage.key(a)},
enabled:function(){return k}}};c.prototype.storage=c.prototype.backends.local;c.prototype.key=function(a){return this.cachePrefix+a};c.prototype.expirekey=function(a){return this.expirePrefix+a};c.prototype.hasExpired=function(a){a=this.expirekey(a);return(a=parseInt(this.storage.get(a),10))&&a<(new Date).getTime()?!0:!1};c.prototype.set=function(a,b,e){if(this.storage.enabled()&&a){var c=this.expirekey(a),a=this.key(a);e&&this.storage.set(c,(new Date).getTime()+1E3*e);b=JSON.stringify(b);return this.storage.set(a,
b)}};c.prototype.get=function(a){if(!this.storage.enabled()||!a)return null;if(this.hasExpired(a))return this.remove(this.key(a)),null;if(a=this.storage.get(this.key(a)))try{return JSON.parse(a)}catch(b){return null}return a};c.prototype.async={set:function(a,b,e){return i(function(){return this.set(a,b,e)}.bind(this))},get:function(a){return i(function(){return this.get(a)}.bind(this))}};c.prototype.remove=function(a){if(this.storage.enabled()){var b=this.expirekey(a),a=this.key(a);this.storage.remove(b);
this.storage.remove(a)}};c.prototype.incr=function(a){if(this.storage.enabled()){var b=parseInt(this.get(a),10);b||(b=0);b++;this.set(a,b);return b}};c.prototype.decr=function(a){if(this.storage.enabled()){var b=parseInt(this.get(a),10);b||(b=0);b--;this.set(a,b);return b}};c.prototype.setMany=function(a,b){if(this.storage.enabled())for(var e in a)a.hasOwnProperty(e)&&this.set(e,a[e],b)};c.prototype.getMany=function(a){for(var b={},e=0;e<a.length;e++)b[a[e]]=this.storage.enabled()?this.get(a[e]):
null;return b};c.prototype.getManyValues=function(a){for(var b=[],e=0;e<a.length;e++)this.storage.enabled()?b.push(this.get(a[e])):b.push(null);return b};c.prototype.removeMany=function(a){if(this.storage.enabled())for(var b=0;b<a.length;b++)this.remove(a[b])};c.prototype.flush=function(){if(this.storage.enabled())for(var a=this.cachePrefix,b=this.storage.length()-1;0<=b;b--){var e=this.storage.key(b);e&&0===e.indexOf(a)&&this.storage.remove(e)}};c.prototype.length=function(){if(!this.storage.enabled())return 0;
for(var a=0,b=this.storage.length(),e=this.cachePrefix,c=0;c<b;c++)0===this.storage.key(c).indexOf(e)&&a++;return a};c.prototype.cleanup=function(){if(this.storage.enabled())for(var a=this.storage.length(),b=this.cachePrefix,c=0;c<a;c++){var d=this.storage.key(c);d&&0===d.indexOf(b)&&(d=d.substring(b.length,d.length),this.hasExpired(d)&&this.remove(d))}};c.prototype.createCache=function(a){return new c(a)};f=new c;f.session=new c({storage:f.backends.session});d.locache=f}).call(this);
